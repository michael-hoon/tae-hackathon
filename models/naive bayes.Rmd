---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
setwd("C:/Users/jopok/OneDrive - Singapore University of Technology and Design/SUTD Term 5/40.016  The Analytics Edge/Kaggle Competition")
#safety<-read.csv("train1.csv")
safety<-read.csv("train1 - Copy.csv")
test<-read.csv("test1.csv")
```

```{r}
library(caTools)
library(e1071)
```

```{r}
str(subsafety)
subsafety<-subset(safety,select=-c(segment,Case,No,Task,CC4,GN4,NS4,BU4,FA4,LD4,BZ4,FC4,FP4,RP4,PP4,KA4,SC4,TS4,NV4,MA4,LB4,AF4,HU4,region,educ,Urb,income,incomea,age,gender,night,nighta,milesa,miles,agea,ppark,year,Price4,Ch1,Ch2,Ch3,Ch4))
```

```{r}
x<-subset(subsafety,select=-c(Choice))
y<-as.factor(subsafety$Choice)

```

```{r}
index<-1:ncol(x)
x[ , index] <- lapply(x[ , index], as.factor)
x<-subset(x,select=c(Price1,Price2,Price3))
model = train(x,y,method='nb',trControl=trainControl(method='cv',number=10))
```

```{r}
x1 <- subset(safety, select=c(Choice,Price1,Price2,Price3, ageind, incomeind, milesind,nightind, yearind,pparkind,segmentind,regionind,educind,Urbind,genderind))
index1<-1:ncol(x1)
x1[ , index1] <- lapply(x1[ , index1], as.factor)
y1<-x1$Choice
x1<-subset(x1,select=-c(Choice))

```

```{r}
model = train(x1,y1,method='nb',trControl=trainControl(method='cv',number=10))
model
```

```{r}
predicted<-predict(model,newdata=test,type="prob")
table(predicted)
```

```{r}
library(naivebayes)
model <- naive_bayes(as.factor(Choice) ~ ., data = x1, usekernel = T)
```

```{r}
summary(model)
sumb<-predict(model,newdata = test,type="prob")
write.csv(sumb,file="submission200.csv")
```

